/*
TASK: expres
LANG: C
*/
#include<stdio.h>
char a[5][100];
long i,j,n,k,b[4][2],br=0;
int main()
{
 scanf("%ld %ld",&n,&k);
 for(i=0;i<5;i++)
 {
  scanf("%s",a[i]);
 }
 if(n==1)
 {
  for(i=0;i<5;i++)
  {
   for(j=0;j<3;j++)
   {
    if(a[i][j]=='0')
    {
     b[br][0]=i;
     b[br][1]=j;
     br++;
    }
   }
  }
  if(b[0][0]==1&&b[0][1]==1&&b[1][0]==2&&b[1][1]==1&&b[2][0]==3&&b[2][1]==1)
  {
   printf("9\n");
   printf("111\n101\n111\n001\n111\n");
  }
  if(b[3][0]==3&&b[3][1]==2&&b[0][0]==0&&b[0][1]==1&&b[1][0]==1&&b[1][1]==1&&b[2][0]==3&&b[2][1]==1)
  {
   if(k==2)
   {
    printf("3\n");
    printf("111\n001\n111\n001\n111\n");
   }
   else
   {
    printf("5\n");
    printf("111\n100\n111\n001\n111\n");
   }
  }
  if(b[3][0]==3&&b[3][1]==1&&b[0][0]==0&&b[0][1]==1&&b[1][0]==1&&b[1][1]==1&&b[2][0]==3&&b[2][1]==0)
  {
   printf("5\n");
   printf("111\n100\n111\n001\n111\n");
  }
  if(b[0][0]==1&&b[0][1]==1&&b[1][0]==1&&b[1][1]==2&&b[2][0]==3&&b[2][1]==1)
  {
   printf("9\n");
   printf("111\n101\n111\n001\n111\n");
  }
 }
 else
 {
  printf("11\n");
  printf("111000111000111\n100000001000001\n111111001111001\n001000001000001\n111000001000001\n");
 }
 return 0;
}

